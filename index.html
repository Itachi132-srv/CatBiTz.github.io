<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>car biTz h9</title>
<style>
body{margin:0;overflow:hidden;background:#0c0c0c;font-family:sans-serif}
.menu,.lose{
position:absolute;top:0;left:0;width:100%;height:100%;
display:flex;flex-direction:column;align-items:center;justify-content:center;
background:#111;color:white;z-index:5}
.lose{background:rgba(0,0,0,0.7);display:none}
button{padding:12px 20px;margin:10px;font-size:18px;border:none;border-radius:10px}
#speed{position:absolute;top:10px;right:10px;color:white;z-index:2}
#info{position:absolute;top:10px;left:10px;color:white;z-index:2}
.ctrl{
position:absolute;width:70px;height:70px;
background:rgba(255,255,255,0.2);
color:white;font-size:28px;
display:flex;align-items:center;justify-content:center;border-radius:12px;z-index:3}
#left{bottom:90px;left:20px}
#right{bottom:90px;left:110px}
#up{bottom:140px;right:20px}
#down{bottom:50px;right:20px}
</style>
</head>
<body>

<div id="menu" class="menu">
<h1>car biTz </h1>
<button onclick="startGame()">Start Game</button>
</div>

<div id="lose" class="lose">
<h2>You Crashed!</h2>
<button onclick="location.reload()">Restart</button>
</div>

<div id="info">Crashes:<span id="cr">0</span> Coins:<span id="coinUI">0</span></div>
<div id="speed">Speed:0</div>

<div id="left" class="ctrl">←</div>
<div id="right" class="ctrl">→</div>
<div id="up" class="ctrl">↑</div>
<div id="down" class="ctrl">↓</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>

<script>
let scene,camera,renderer,car;
let speed=0,crashes=0,coins=0;
let keys={},obstacles=[],coinObjs=[];
let equipped=0;

let cars=[
{name:"Starter",top:0.5,color:0xff4444},
{name:"Sport",top:0.7,color:0x44ff44},
{name:"Hyper",top:1.0,color:0x4444ff}
];

function makeCarModel(){
let g=new THREE.Group();

let body=new THREE.Mesh(
new THREE.BoxGeometry(3,1.2,6),
new THREE.MeshStandardMaterial({color:cars[equipped].color})
);
body.position.y=1;
g.add(body);

let top=new THREE.Mesh(
new THREE.BoxGeometry(2.5,1,2.5),
new THREE.MeshStandardMaterial({color:0xffffff})
);
top.position.set(0,2,0);
g.add(top);

return g;
}

function startGame(){

menu.style.display="none";

scene=new THREE.Scene();
scene.background=new THREE.Color(0x87ceeb);

camera=new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000);
renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
document.body.appendChild(renderer.domElement);

scene.add(new THREE.AmbientLight(0xffffff,0.6));
let sun=new THREE.DirectionalLight(0xffffff,1);
sun.position.set(50,100,50);
scene.add(sun);

car=makeCarModel();
scene.add(car);

generateRoad(0);

animate();
}

function generateRoad(zStart){
for(let i=0;i<10;i++){
let z=zStart-(i*80);

let road=new THREE.Mesh(
new THREE.PlaneGeometry(20,80),
new THREE.MeshStandardMaterial({color:0x222222})
);
road.rotation.x=-Math.PI/2;
road.position.z=z;
scene.add(road);

let barrierL=new THREE.Mesh(
new THREE.BoxGeometry(2,3,80),
new THREE.MeshStandardMaterial({color:0xffff00})
);
barrierL.position.set(-12,1.5,z);
scene.add(barrierL);

let barrierR=barrierL.clone();
barrierR.position.x=12;
scene.add(barrierR);

if(Math.random()<0.7){
let box=new THREE.Mesh(
new THREE.BoxGeometry(3,3,3),
new THREE.MeshStandardMaterial({color:0xffaa00})
);
box.position.set((Math.random()*10)-5,1.5,z-20);
scene.add(box);
obstacles.push(box);
}

for(let c=0;c<3;c++){
let coin=new THREE.Mesh(
new THREE.CylinderGeometry(1,1,0.3,12),
new THREE.MeshStandardMaterial({color:0xffff00})
);
coin.rotation.x=Math.PI/2;
coin.position.set((Math.random()*10)-5,1,z-(c*10));
scene.add(coin);
coinObjs.push(coin);
}
}
}

["left","right","up","down"].forEach(id=>{
document.getElementById(id).ontouchstart=()=>keys[id]=true;
document.getElementById(id).ontouchend=()=>keys[id]=false;
});

function update(){

let top=cars[equipped].top;

if(keys.up)speed+=0.02;
if(keys.down)speed-=0.02;
speed=Math.max(Math.min(speed,top),-top);
speed*=0.98;

if(keys.left)car.rotation.y+=0.05;
if(keys.right)car.rotation.y-=0.05;

car.position.x+=Math.sin(car.rotation.y)*speed*10;
car.position.z+=Math.cos(car.rotation.y)*speed*10;

if(car.position.x<-10)car.position.x=-10;
if(car.position.x>10)car.position.x=10;

obstacles.forEach(o=>{
if(car.position.distanceTo(o.position)<3){
crashes++;
cr.innerText=crashes;
speed*=-0.5;
if(crashes>=3)lose.style.display="flex";
}
});

coinObjs.forEach(c=>{
if(car.position.distanceTo(c.position)<3){
scene.remove(c);
coins++;
coinUI.innerText=coins;
}
});

if(car.position.z<-500){
generateRoad(car.position.z-200);
}

camera.position.set(
car.position.x- Math.sin(car.rotation.y)*15,
10,
car.position.z- Math.cos(car.rotation.y)*15
);
camera.lookAt(car.position);

speedEl=document.getElementById("speed");
speedEl.innerText="Speed:"+Math.floor(Math.abs(speed*200));
}

function animate(){
requestAnimationFrame(animate);
update();
renderer.render(scene,camera);
}
</script>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Mobile 3D Car Game</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<style>
body{margin:0;overflow:hidden;background:black;font-family:Arial}
canvas{display:block}
#ui{position:fixed;top:10px;left:10px;color:white}
#menu{
position:fixed;inset:0;background:black;color:white;
display:flex;flex-direction:column;align-items:center;justify-content:center;
gap:10px
}
button{padding:10px 20px;font-size:16px}
.controls{
position:fixed;bottom:20px;width:100%;
display:flex;justify-content:space-between;padding:20px;
box-sizing:border-box
}
.ctrl{background:#ffffff33;color:white;border:none;
padding:15px 20px;font-size:20px}
</style>
</head>
<body>

<div id="menu">
<h1>3D CAR GAME</h1>
<button onclick="startGame()">START</button>
<button onclick="rotateScreen()">ROTATE SCREEN</button>
</div>

<div id="ui">Score: <span id="score">0</span> | Health: <span id="hp">100</span></div>

<div class="controls">
<div>
<button class="ctrl" ontouchstart="keys.left=1" ontouchend="keys.left=0">◀</button>
<button class="ctrl" ontouchstart="keys.right=1" ontouchend="keys.right=0">▶</button>
</div>
<div>
<button class="ctrl" ontouchstart="keys.up=1" ontouchend="keys.up=0">▲</button>
<button class="ctrl" ontouchstart="keys.down=1" ontouchend="keys.down=0">▼</button>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>

<script>
let scene,camera,renderer,car;
let coins=[],obstacles=[];
let score=0,health=100;
let keys={};
let running=false;

function rotateScreen(){
 if(screen.orientation && screen.orientation.lock){
  screen.orientation.lock("landscape").catch(()=>{});
 }
}

function startGame(){
 document.getElementById("menu").style.display="none";
 init();
 running=true;
 animate();
}

function init(){
 scene=new THREE.Scene();
 camera=new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000);
 renderer=new THREE.WebGLRenderer();
 renderer.setSize(innerWidth,innerHeight);
 document.body.appendChild(renderer.domElement);

 let light=new THREE.DirectionalLight(0xffffff,1);
 light.position.set(5,10,5);
 scene.add(light);

 let ground=new THREE.Mesh(
 new THREE.PlaneGeometry(500,500),
 new THREE.MeshStandardMaterial({color:0x222222})
 );
 ground.rotation.x=-Math.PI/2;
 scene.add(ground);

 // road
 let road=new THREE.Mesh(
 new THREE.PlaneGeometry(20,500),
 new THREE.MeshStandardMaterial({color:0x555555})
 );
 road.rotation.x=-Math.PI/2;
 road.position.y=0.01;
 scene.add(road);

 // buildings
 for(let i=0;i<30;i++){
  let b=new THREE.Mesh(
   new THREE.BoxGeometry(5,Math.random()*10+5,5),
   new THREE.MeshStandardMaterial({color:0x888888})
  );
  b.position.set((Math.random()>0.5?30:-30),3,Math.random()*400-200);
  scene.add(b);
 }

 // car
 car=new THREE.Mesh(
 new THREE.BoxGeometry(2,1,4),
 new THREE.MeshStandardMaterial({color:0xff0000})
 );
 car.position.y=0.5;
 scene.add(car);

 // coins
 for(let i=0;i<20;i++){
  let c=new THREE.Mesh(
   new THREE.BoxGeometry(1,1,1),
   new THREE.MeshStandardMaterial({color:0xffff00})
  );
  c.position.set(Math.random()*10-5,0.5,Math.random()*-200);
  scene.add(c);
  coins.push(c);
 }

 // obstacles
 for(let i=0;i<15;i++){
  let o=new THREE.Mesh(
   new THREE.BoxGeometry(2,2,2),
   new THREE.MeshStandardMaterial({color:0x00ff00})
  );
  o.position.set(Math.random()*10-5,1,Math.random()*-200);
  scene.add(o);
  obstacles.push(o);
 }

 camera.position.set(0,5,10);
}

function update(){
 if(keys.up)car.position.z-=0.3;
 if(keys.down)car.position.z+=0.3;
 if(keys.left)car.position.x-=0.3;
 if(keys.right)car.position.x+=0.3;

 // coin collect
 coins.forEach(c=>{
  if(c.visible && car.position.distanceTo(c.position)<2){
   c.visible=false;
   score+=10;
  }
 });

 // obstacle hit
 obstacles.forEach(o=>{
  if(car.position.distanceTo(o.position)<2){
   health-=1;
  }
 });

 if(health<=0){
  running=false;
  alert("Game Over");
  location.reload();
 }

 document.getElementById("score").innerText=score;
 document.getElementById("hp").innerText=health;

 camera.position.x=car.position.x;
 camera.position.z=car.position.z+10;
 camera.lookAt(car.position);
}

function animate(){
 if(!running)return;
 requestAnimationFrame(animate);
 update();
 renderer.render(scene,camera);
}

window.addEventListener("keydown",e=>{
 if(e.key==="ArrowUp")keys.up=1;
 if(e.key==="ArrowDown")keys.down=1;
 if(e.key==="ArrowLeft")keys.left=1;
 if(e.key==="ArrowRight")keys.right=1;
});
window.addEventListener("keyup",()=>keys={});

</script>
</body>
</html>

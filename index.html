<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>car biTz h9</title>
<style>
body{margin:0;overflow:hidden;background:#0c0c0c;font-family:sans-serif}

.menu,.lose{
position:absolute;top:0;left:0;width:100%;height:100%;
display:flex;flex-direction:column;align-items:center;justify-content:center;
background:#111;color:white;z-index:5}

.lose{background:rgba(0,0,0,0.7);display:none}

button{
padding:12px 20px;margin:10px;font-size:18px;
border:none;border-radius:10px}

#speed{
position:absolute;top:10px;right:10px;
color:white;font-size:18px;z-index:2}

#crashUI{
position:absolute;top:10px;left:10px;
color:white;z-index:2}

.ctrl{
position:absolute;width:70px;height:70px;
background:rgba(255,255,255,0.2);
color:white;font-size:28px;
display:flex;align-items:center;justify-content:center;
border-radius:12px;z-index:3}

/* LEFT SIDE STEERING */
#left{bottom:90px;left:20px}
#right{bottom:90px;left:110px}

/* RIGHT SIDE SPEED */
#up{bottom:140px;right:20px}
#down{bottom:50px;right:20px}

</style>
</head>
<body>

<div id="menu" class="menu">
<h1>car biTz h9</h1>
<button onclick="startGame()">Start Game</button>
<button onclick="openShop()">Shop</button>
</div>

<div id="shop" class="menu" style="display:none">
<h2>Select Car</h2>
<div id="carBtns"></div>
<button onclick="backMenu()">Back</button>
</div>

<div id="lose" class="lose">
<h2>You Crashed!</h2>
<button onclick="restart()">Restart</button>
<button onclick="mainMenu()">Main Menu</button>
</div>

<div id="crashUI">Crashes:<span id="cr">0</span></div>
<div id="speed">Speed:0</div>

<div id="left" class="ctrl">←</div>
<div id="right" class="ctrl">→</div>
<div id="up" class="ctrl">↑</div>
<div id="down" class="ctrl">↓</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>

<script>
let scene,camera,renderer,car;
let crashes=0,keys={},speed=0,equipped=0;
let obstacles=[];

let cars=[
{name:"Starter",color:0xff4444,top:0.5},
{name:"Sport",color:0x44ff44,top:0.8},
{name:"Hyper",color:0x4444ff,top:1.1}
];

function makeCarModel(i){
let g=new THREE.Group();

let body=new THREE.Mesh(
new THREE.BoxGeometry(3,1.2,6),
new THREE.MeshStandardMaterial({color:cars[i].color})
);
body.position.y=1;
g.add(body);

if(i==1){
let spoiler=new THREE.Mesh(
new THREE.BoxGeometry(3,0.3,1),
new THREE.MeshStandardMaterial({color:0x000000})
);
spoiler.position.set(0,2,-3);
g.add(spoiler);
}

if(i==2){
let fin=new THREE.Mesh(
new THREE.BoxGeometry(1,1,2),
new THREE.MeshStandardMaterial({color:0xffffff})
);
fin.position.set(0,2,0);
g.add(fin);
}
return g;
}

function openShop(){
menu.style.display="none";
shop.style.display="flex";
carBtns.innerHTML="";
cars.forEach((c,i)=>{
let b=document.createElement("button");
b.innerText="Equip "+c.name;
b.onclick=()=>equipped=i;
carBtns.appendChild(b);
});
}

function backMenu(){
shop.style.display="none";
menu.style.display="flex";
}

function mainMenu(){
location.reload();
}

function startGame(){
menu.style.display="none";
shop.style.display="none";

scene=new THREE.Scene();
scene.background=new THREE.Color(0x87ceeb);

camera=new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000);
renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
document.body.appendChild(renderer.domElement);

scene.add(new THREE.AmbientLight(0xffffff,0.6));
let sun=new THREE.DirectionalLight(0xffffff,1);
sun.position.set(50,100,50);
scene.add(sun);

let ground=new THREE.Mesh(
new THREE.PlaneGeometry(200,2000),
new THREE.MeshStandardMaterial({color:0x3cb371})
);
ground.rotation.x=-Math.PI/2;
scene.add(ground);

for(let i=0;i<20;i++){
let r=new THREE.Mesh(
new THREE.PlaneGeometry(20,100),
new THREE.MeshStandardMaterial({color:0x222222})
);
r.rotation.x=-Math.PI/2;
r.position.z=-i*100;
scene.add(r);

let box=new THREE.Mesh(
new THREE.BoxGeometry(3,3,3),
new THREE.MeshStandardMaterial({color:0xffaa00})
);
box.position.set((Math.random()*10)-5,1.5,r.position.z-20);
scene.add(box);
obstacles.push(box);
}

car=makeCarModel(equipped);
scene.add(car);

animate();
}

["left","right","up","down"].forEach(id=>{
document.getElementById(id).ontouchstart=()=>keys[id]=true;
document.getElementById(id).ontouchend=()=>keys[id]=false;
});

function loseGame(){
lose.style.display="flex";
}

function restart(){
location.reload();
}

function update(){
let top=cars[equipped].top;

if(keys.up)speed+=0.02;
if(keys.down)speed-=0.02;
speed=Math.max(Math.min(speed,top),-top);
speed*=0.98;

if(keys.left)car.rotation.y+=0.05*(Math.abs(speed)*5+0.2);
if(keys.right)car.rotation.y-=0.05*(Math.abs(speed)*5+0.2);

car.position.x+=Math.sin(car.rotation.y)*speed*10;
car.position.z+=Math.cos(car.rotation.y)*speed*10;

obstacles.forEach(o=>{
if(car.position.distanceTo(o.position)<3){
crashes++;
cr.innerText=crashes;
speed*=-0.5;
if(crashes>=3)loseGame();
}
});

camera.position.set(
car.position.x- Math.sin(car.rotation.y)*15,
10,
car.position.z- Math.cos(car.rotation.y)*15
);
camera.lookAt(car.position);

document.getElementById("speed").innerText=
"Speed:"+Math.floor(Math.abs(speed*200));
}

function animate(){
requestAnimationFrame(animate);
update();
renderer.render(scene,camera);
}
</script>
</body>
</html>

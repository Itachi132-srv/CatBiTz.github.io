<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>car biTz h9</title>
<style>
body{margin:0;overflow:hidden;background:black;font-family:sans-serif}
#ui{position:absolute;top:10px;left:10px;color:white;background:rgba(0,0,0,0.5);padding:8px;border-radius:8px}
.btn{
position:absolute;width:60px;height:60px;
background:rgba(255,255,255,0.2);
color:white;font-size:25px;
display:flex;align-items:center;justify-content:center;
border-radius:10px;user-select:none}
#up{bottom:120px;left:80px}
#down{bottom:40px;left:80px}
#left{bottom:80px;left:10px}
#right{bottom:80px;left:150px}
</style>
</head>
<body>

<div id="ui">car biTz h9<br>Crashes: <span id="crash">0</span></div>

<div id="up" class="btn">↑</div>
<div id="down" class="btn">↓</div>
<div id="left" class="btn">←</div>
<div id="right" class="btn">→</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>

<script>
let scene=new THREE.Scene();
scene.background=new THREE.Color(0x87ceeb);

let camera=new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000);
let renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
document.body.appendChild(renderer.domElement);

scene.add(new THREE.AmbientLight(0xffffff,0.6));
let sun=new THREE.DirectionalLight(0xffffff,1);
sun.position.set(50,100,50);
scene.add(sun);

let ground=new THREE.Mesh(
new THREE.PlaneGeometry(500,500),
new THREE.MeshStandardMaterial({color:0x3cb371})
);
ground.rotation.x=-Math.PI/2;
scene.add(ground);

function road(x,z,w,h){
let r=new THREE.Mesh(
new THREE.PlaneGeometry(w,h),
new THREE.MeshStandardMaterial({color:0x222222})
);
r.rotation.x=-Math.PI/2;
r.position.set(x,0.01,z);
scene.add(r);
}
road(0,0,40,400);
road(0,0,400,40);

let buildings=[];
for(let i=-180;i<=180;i+=40){
let b=new THREE.Mesh(
new THREE.BoxGeometry(20,20+Math.random()*30,20),
new THREE.MeshStandardMaterial({color:Math.random()*0xffffff})
);
b.position.set(60,b.geometry.parameters.height/2,i);
scene.add(b);buildings.push(b);

let b2=b.clone();b2.position.x=-60;
scene.add(b2);buildings.push(b2);
}

let car=new THREE.Group();
let body=new THREE.Mesh(
new THREE.BoxGeometry(4,1.5,8),
new THREE.MeshStandardMaterial({color:0xff4444})
);
body.position.y=1;car.add(body);

let topc=new THREE.Mesh(
new THREE.BoxGeometry(3,1.5,3),
new THREE.MeshStandardMaterial({color:0x1111ff})
);
topc.position.set(0,2,0);car.add(topc);
scene.add(car);

let speed=0,crashes=0;
let keys={up:false,down:false,left:false,right:false};

document.addEventListener("keydown",e=>{
if(e.key=="w"||e.key=="ArrowUp")keys.up=true;
if(e.key=="s"||e.key=="ArrowDown")keys.down=true;
if(e.key=="a"||e.key=="ArrowLeft")keys.left=true;
if(e.key=="d"||e.key=="ArrowRight")keys.right=true;
});
document.addEventListener("keyup",e=>{
if(e.key=="w"||e.key=="ArrowUp")keys.up=false;
if(e.key=="s"||e.key=="ArrowDown")keys.down=false;
if(e.key=="a"||e.key=="ArrowLeft")keys.left=false;
if(e.key=="d"||e.key=="ArrowRight")keys.right=false;
});

function touch(id,key){
let el=document.getElementById(id);
el.ontouchstart=()=>keys[key]=true;
el.ontouchend=()=>keys[key]=false;
}
touch("up","up");
touch("down","down");
touch("left","left");
touch("right","right");

function explode(){
let boom=new THREE.Mesh(
new THREE.SphereGeometry(3,16,16),
new THREE.MeshBasicMaterial({color:0xffaa00})
);
boom.position.copy(car.position);
scene.add(boom);
setTimeout(()=>scene.remove(boom),500);
car.position.set(0,0,0);
speed=0;crashes=0;
}

function update(){
if(keys.up)speed+=0.03;
if(keys.down)speed-=0.03;
speed*=0.97;

if(keys.left)car.rotation.y+=0.04*(speed*3);
if(keys.right)car.rotation.y-=0.04*(speed*3);

car.position.x+=Math.sin(car.rotation.y)*speed*2;
car.position.z+=Math.cos(car.rotation.y)*speed*2;

for(let b of buildings){
if(car.position.distanceTo(b.position)<12){
crashes++;
document.getElementById("crash").innerText=crashes;
speed*=-0.5;
if(crashes>=3)explode();
}
}

camera.position.x=car.position.x- Math.sin(car.rotation.y)*18;
camera.position.z=car.position.z- Math.cos(car.rotation.y)*18;
camera.position.y=12;
camera.lookAt(car.position);
}

function animate(){
requestAnimationFrame(animate);
update();
renderer.render(scene,camera);
}
animate();

onresize=()=>{
camera.aspect=innerWidth/innerHeight;
camera.updateProjectionMatrix();
renderer.setSize(innerWidth,innerHeight);
};
</script>
</body>
</html>
